<div class="router-outlet">
  <h3 class="header-text">Your products</h3>

  <app-cart-contents *ngFor="let product of products;let i = index;" [product]="product" (updateQuantity)="updateProductQuantity($event)" [productArrayNumber]="i"> </app-cart-contents>

   <!--TODO: Dynamically fetch from backend-->
  <div *ngIf="products.length">
    <h4 class="shipping-text standard-font" *ngIf="(25 - totalPrice) > 0">Spend {{25 - totalPrice | currency: 'GBP'}} more for Free Delivery!</h4>
    <h4 class="shipping-text standard-font" *ngIf="(25 - totalPrice) <= 0">Free Standard Delivery Available!</h4>
    <div class="shipping-option-choice">
      <label for="shippingOption">Shipping Option</label>
      <select name="shippingOption" id="shippingOption" (change)="updateShipping($event.target.value)">
        <option value="standard" [selected]="!isCollection && !premiumDeliverySelected" *ngIf="totalPrice < 25">Standard (3-7 days): £2.99</option>
        <option value="standard" [selected]="!isCollection && !premiumDeliverySelected" *ngIf="totalPrice >= 25">Standard (3-7 days): FREE</option>
        <option value="premium" [selected]="!isCollection && premiumDeliverySelected">Premium (48 hours): £8.39</option>
        <option value="collection" [selected]="isCollection">Collection - Free</option>
      </select>
    </div>
    <div class="coupon-option">
      <div class="coupon-input">
        <label for="couponCode">Got a Coupon?</label>
        <input type="text" name="couponCode" id="couponCode" [(ngModel)]="couponCode" placeholder="Enter Coupon" />
      </div>
      <div class="coupon-button">
        <button class="button inverted small-button" (click)="applyCoupon()">Apply Coupon</button>
      </div>
    </div>
    <div class="coupon-banner-error" *ngIf="couponError">
      {{couponError}}
    </div>
    <div class="coupon-banner-success" *ngIf="couponDiscount && discountType === 'percentage'">
      Applied {{couponDiscount}}% discount!
    </div>
    <div class="coupon-banner-success" *ngIf="couponDiscount && discountType === 'deliveryDiscount' && shippingCost > 0">
      Discounted shipping by {{couponDiscount | currency: 'GBP'}}!
    </div>
    <div class="coupon-banner-success" *ngIf="couponDiscount && discountType === 'deliveryDiscount' && shippingCost === 0">
      Free shipping applied!
    </div>
    <h4 class="total-price"><span *ngIf="couponDiscount">Discounted </span>Total Price: {{totalPrice + shippingCost | currency: 'GBP'}}</h4>

    <div class="button-wrapper">
      <button class="button inverted" routerLink="/shop">Continue Shopping</button>
      <button class="button" *ngIf="products.length" (click)="checkout()">Go to Checkout</button>
    </div>
  </div>

  <div *ngIf="!products.length">
    <h4 class="shipping-text standard-font">Your basket is empty - let's go shopping!</h4>

    <div class="button-wrapper">
      <button class="button" routerLink="/shop">Shop Now</button>
    </div>
  </div>
</div>
